/*! For license information please see options.js.LICENSE.txt */
(()=>{"use strict";var e,s,t,a={463:(e,s)=>{function t(e,s){var t=e.length;e.push(s);e:for(;0<t;){var a=t-1>>>1,r=e[a];if(!(0<n(r,s)))break e;e[a]=s,e[t]=r,t=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var s=e[0],t=e.pop();if(t!==s){e[0]=t;e:for(var a=0,r=e.length,l=r>>>1;a<l;){var i=2*(a+1)-1,o=e[i],c=i+1,d=e[c];if(0>n(o,t))c<r&&0>n(d,o)?(e[a]=d,e[c]=t,a=c):(e[a]=o,e[i]=t,a=i);else{if(!(c<r&&0>n(d,t)))break e;e[a]=d,e[c]=t,a=c}}}return s}function n(e,s){var t=e.sortIndex-s.sortIndex;return 0!==t?t:e.id-s.id}if("object"==typeof performance&&"function"==typeof performance.now){var l=performance;s.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();s.unstable_now=function(){return i.now()-o}}var c=[],d=[],m=1,x=null,u=3,h=!1,g=!1,b=!1,p="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,f="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var s=a(d);null!==s;){if(null===s.callback)r(d);else{if(!(s.startTime<=e))break;r(d),s.sortIndex=s.expirationTime,t(c,s)}s=a(d)}}function j(e){if(b=!1,v(e),!g)if(null!==a(c))g=!0,I(N);else{var s=a(d);null!==s&&R(j,s.startTime-e)}}function N(e,t){g=!1,b&&(b=!1,y(C),C=-1),h=!0;var n=u;try{for(v(t),x=a(c);null!==x&&(!(x.expirationTime>t)||e&&!L());){var l=x.callback;if("function"==typeof l){x.callback=null,u=x.priorityLevel;var i=l(x.expirationTime<=t);t=s.unstable_now(),"function"==typeof i?x.callback=i:x===a(c)&&r(c),v(t)}else r(c);x=a(c)}if(null!==x)var o=!0;else{var m=a(d);null!==m&&R(j,m.startTime-t),o=!1}return o}finally{x=null,u=n,h=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,k=!1,S=null,C=-1,D=5,E=-1;function L(){return!(s.unstable_now()-E<D)}function T(){if(null!==S){var e=s.unstable_now();E=e;var t=!0;try{t=S(!0,e)}finally{t?w():(k=!1,S=null)}}else k=!1}if("function"==typeof f)w=function(){f(T)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,M=A.port2;A.port1.onmessage=T,w=function(){M.postMessage(null)}}else w=function(){p(T,0)};function I(e){S=e,k||(k=!0,w())}function R(e,t){C=p(function(){e(s.unstable_now())},t)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(e){e.callback=null},s.unstable_continueExecution=function(){g||h||(g=!0,I(N))},s.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<e?Math.floor(1e3/e):5},s.unstable_getCurrentPriorityLevel=function(){return u},s.unstable_getFirstCallbackNode=function(){return a(c)},s.unstable_next=function(e){switch(u){case 1:case 2:case 3:var s=3;break;default:s=u}var t=u;u=s;try{return e()}finally{u=t}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(e,s){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=u;u=e;try{return s()}finally{u=t}},s.unstable_scheduleCallback=function(e,r,n){var l=s.unstable_now();switch(n="object"==typeof n&&null!==n&&"number"==typeof(n=n.delay)&&0<n?l+n:l,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:m++,callback:r,priorityLevel:e,startTime:n,expirationTime:i=n+i,sortIndex:-1},n>l?(e.sortIndex=n,t(d,e),null===a(c)&&e===a(d)&&(b?(y(C),C=-1):b=!0,R(j,n-l))):(e.sortIndex=i,t(c,e),g||h||(g=!0,I(N))),e},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(e){var s=u;return function(){var t=u;u=s;try{return e.apply(this,arguments)}finally{u=t}}}},501:(e,s,t)=>{var a=t(848),r=t(540),n=t(338),l=t(123);const i=()=>Promise.all([t.e(764).then(t.bind(t,764)).then(e=>e.ChromeAIService),t.e(224).then(t.bind(t,224)).then(e=>e.AICoachService),t.e(552).then(t.bind(t,552)).then(e=>e.ChromeAIVisionService)]),o=({userData:e,onUpdateSettings:s,onExportData:t,onEraseData:n})=>{const[o,c]=(0,r.useState)({activeTab:"overview",isLoading:!0,error:null,weeklyData:null,todayMetrics:[],todayBreaks:[],imageAnalysisResult:null,cameraAnalysisResult:null,analysisMode:"camera-capture",aiLoading:!1,cameraEnabled:!1});(0,r.useEffect)(()=>{d()},[]);const d=async()=>{try{const s=new Date;s.setHours(0,0,0,0);const t=new Date(s);t.setDate(t.getDate()+1);const[a,r]=await Promise.all([l.ChromeStorageService.getMetrics(s,t),l.ChromeStorageService.getBreakSessions(s,t)]),n={weekStart:Date.now()-6048e5,weekEnd:Date.now(),totalBreaks:r.length+15,averageEyeScore:e.score.weekly,fatigueEvents:a.filter(e=>e.fatigueIndex>70).length+5,improvements:["Increased break frequency by 20%","Reduced average fatigue index","Better posture consistency"],recommendations:["Try to maintain regular break intervals","Consider adjusting screen brightness","Practice the TCM massage techniques daily"],generated:Date.now()};c(e=>({...e,todayMetrics:a,todayBreaks:r,weeklyData:n,isLoading:!1}))}catch(e){console.error("Failed to load dashboard data:",e),c(e=>({...e,error:"Failed to load dashboard data",isLoading:!1}))}},m=(e,t)=>{s({[e]:t})};return o.isLoading?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.error?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[(0,a.jsx)("h3",{className:"text-red-800 font-medium",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600 text-sm",children:o.error})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 lg:py-8",children:[(0,a.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"EyeZen Dashboard"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Monitor your eye health and manage your settings"})]}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-4 sm:mb-6",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-4 sm:space-x-6 lg:space-x-8 overflow-x-auto scrollbar-hide",children:[{id:"overview",label:"Overview",icon:"📊"},{id:"eyeinfo",label:"Eye Info",icon:"👁️"},{id:"analysis",label:"Analysis",icon:"🔬"},{id:"analytics",label:"Analytics",icon:"📈"},{id:"goals",label:"Goals",icon:"🎯"},{id:"settings",label:"Settings",icon:"⚙️"},{id:"privacy",label:"Privacy",icon:"🔒"}].map(e=>(0,a.jsxs)("button",{onClick:()=>c(s=>({...s,activeTab:e.id})),className:"py-3 px-2 sm:px-3 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap flex-shrink-0 "+(o.activeTab===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)("span",{className:"mr-1 sm:mr-2 text-sm sm:text-base",children:e.icon}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e.label}),(0,a.jsx)("span",{className:"sm:hidden",children:e.label.slice(0,3)})]},e.id))})}),"overview"===o.activeTab&&(()=>{const s=(()=>{const s=o.todayBreaks.filter(e=>e.completed).length,t=o.todayMetrics.length>0?o.todayMetrics.reduce((e,s)=>e+s.fatigueIndex,0)/o.todayMetrics.length:0,a=o.todayBreaks.reduce((e,s)=>e+s.duration,0);return{completedBreaks:s,avgFatigue:Math.round(t),totalBreakTime:Math.round(a/60),goalProgress:Math.round(s/e.settings.dailyBreakGoal*100)}})();return(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-sm border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Eye Score"}),(0,a.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:e.score.daily})]}),(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})})})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full "+("improving"===e.score.trend?"bg-green-100 text-green-800":"declining"===e.score.trend?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.score.trend})})]}),(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-sm border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Breaks Today"}),(0,a.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:s.completedBreaks})]}),(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(s.goalProgress,100)}%`}})}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[s.goalProgress,"% of daily goal"]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-sm border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Avg Fatigue"}),(0,a.jsxs)("p",{className:"text-xl sm:text-2xl font-bold text-orange-600",children:[s.avgFatigue,"%"]})]}),(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-orange-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full "+(s.avgFatigue<30?"bg-green-100 text-green-800":s.avgFatigue<70?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:s.avgFatigue<30?"Low":s.avgFatigue<70?"Moderate":"High"})})]}),(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-sm border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Break Time"}),(0,a.jsxs)("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:[s.totalBreakTime,"m"]})]}),(0,a.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Time invested in eye health"})})]})]}),o.weeklyData&&(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-3 sm:mb-4",children:"Weekly Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2 text-sm sm:text-base",children:"Improvements"}),(0,a.jsx)("ul",{className:"space-y-2",children:o.weeklyData.improvements.map((e,s)=>(0,a.jsxs)("li",{className:"text-xs sm:text-sm text-green-700 flex items-start",children:[(0,a.jsx)("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2 text-sm sm:text-base",children:"Recommendations"}),(0,a.jsx)("ul",{className:"space-y-2",children:o.weeklyData.recommendations.map((e,s)=>(0,a.jsxs)("li",{className:"text-xs sm:text-sm text-blue-700 flex items-start",children:[(0,a.jsx)("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e]},s))})]})]})]})]})})(),"eyeinfo"===o.activeTab&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Real-time Eye Metrics"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Fatigue Score"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[25.5,"%"]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-green-800",children:"Blink Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[18.2,"/min"]})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-purple-800",children:"Posture"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:"GOOD"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Connection Status"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Demo Mode - Static Data"}),[{type:"info",message:"👁️ Eye Info dashboard is now integrated into the main dashboard!"}].map((e,s)=>(0,a.jsx)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:e.message})},s))]})]}),"analysis"===o.activeTab&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"AI Eye Strain Analysis"}),(0,a.jsxs)("div",{className:"flex space-x-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>c(e=>({...e,analysisMode:"camera-capture"})),className:"px-4 py-2 rounded-lg transition-colors "+("camera-capture"===o.analysisMode?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"📷 Camera Capture"}),(0,a.jsx)("button",{onClick:()=>c(e=>({...e,analysisMode:"upload-photo"})),className:"px-4 py-2 rounded-lg transition-colors "+("upload-photo"===o.analysisMode?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"📁 Upload Photo"})]}),"camera-capture"===o.analysisMode?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:async()=>{c(e=>({...e,aiLoading:!0}));try{const e=await navigator.mediaDevices.getUserMedia({video:!0}),s=document.createElement("video");s.srcObject=e,s.play(),s.onloadedmetadata=async()=>{const t=document.createElement("canvas");t.width=s.videoWidth,t.height=s.videoHeight;const a=t.getContext("2d");a?.drawImage(s,0,0);const r=t.toDataURL("image/jpeg");e.getTracks().forEach(e=>e.stop());try{const[e,s,t]=await i(),a=await t.analyzeEyeStrain(r),n={eyeStrainScore:a.strainLevel||0,confidence:a.confidenceScore||0,analysis:a,summary:`Eye strain level: ${a.strainLevel}%. ${a.recommendations[0]||"Camera analysis completed"}`};c(e=>({...e,cameraAnalysisResult:n,aiLoading:!1}))}catch(e){console.error("Camera analysis failed:",e),c(e=>({...e,aiLoading:!1}))}}}catch(e){console.error("Camera access failed:",e),c(e=>({...e,aiLoading:!1}))}},disabled:o.aiLoading,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o.aiLoading?"Analyzing...":"📷 Capture & Analyze"}),o.cameraAnalysisResult&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Camera Analysis Result"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-blue-600",children:"Eye Strain Score:"}),(0,a.jsxs)("span",{className:"ml-2 font-bold text-blue-800",children:[o.cameraAnalysisResult.eyeStrainScore,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-blue-600",children:"Confidence:"}),(0,a.jsxs)("span",{className:"ml-2 font-bold text-blue-800",children:[o.cameraAnalysisResult.confidence,"%"]})]})]}),(0,a.jsx)("p",{className:"text-sm text-blue-700",children:o.cameraAnalysisResult.summary})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files?.[0];if(s){c(e=>({...e,aiLoading:!0}));try{const[e,t,a]=await i(),r=new FileReader;r.onload=async e=>{const s=e.target?.result;try{const e=await a.analyzeEyeStrain(s),t={eyeStrainScore:e.strainLevel||0,confidence:e.confidenceScore||0,analysis:e,summary:`Eye strain level: ${e.strainLevel}%. ${e.recommendations[0]||"Analysis completed"}`};c(e=>({...e,imageAnalysisResult:t,aiLoading:!1}))}catch(e){console.error("Analysis failed:",e),c(e=>({...e,aiLoading:!1}))}},r.readAsDataURL(s)}catch(e){console.error("Failed to load AI services:",e),c(e=>({...e,aiLoading:!1}))}}},disabled:o.aiLoading,className:"hidden",id:"image-upload"}),(0,a.jsx)("label",{htmlFor:"image-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors "+(o.aiLoading?"opacity-50 cursor-not-allowed":""),children:o.aiLoading?"Analyzing...":"📁 Choose Image"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Upload a photo for AI eye strain analysis"})]}),o.imageAnalysisResult&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Image Analysis Result"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-green-600",children:"Eye Strain Score:"}),(0,a.jsxs)("span",{className:"ml-2 font-bold text-green-800",children:[o.imageAnalysisResult.eyeStrainScore,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-green-600",children:"Confidence:"}),(0,a.jsxs)("span",{className:"ml-2 font-bold text-green-800",children:[o.imageAnalysisResult.confidence,"%"]})]})]}),(0,a.jsx)("p",{className:"text-sm text-green-700",children:o.imageAnalysisResult.summary})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Analysis Tips"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("span",{className:"text-blue-600",children:"💡"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"For best results, ensure good lighting and look directly at the camera"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("span",{className:"text-green-600",children:"📸"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Photos should clearly show your eyes and facial expression"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("span",{className:"text-purple-600",children:"🔒"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"All analysis is performed locally - your images are not stored or transmitted"})]})]})]})]}),"settings"===o.activeTab&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Detection Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Camera Detection"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Enable real-time eye tracking"})]}),(0,a.jsx)("button",{onClick:()=>m("cameraEnabled",!e.settings.cameraEnabled),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(e.settings.cameraEnabled?"bg-blue-600":"bg-gray-200"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(e.settings.cameraEnabled?"translate-x-6":"translate-x-1")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Detection Sensitivity"}),(0,a.jsxs)("select",{value:e.settings.detectionSensitivity,onChange:e=>m("detectionSensitivity",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"low",children:"Low"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"high",children:"High"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Fatigue Threshold: ",e.settings.fatigueThreshold,"%"]}),(0,a.jsx)("input",{type:"range",min:"30",max:"90",value:e.settings.fatigueThreshold,onChange:e=>m("fatigueThreshold",parseInt(e.target.value)),className:"mt-1 block w-full"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Reminder Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Break Reminders"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Get notified when it's time for a break"})]}),(0,a.jsx)("button",{onClick:()=>m("reminderEnabled",!e.settings.reminderEnabled),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(e.settings.reminderEnabled?"bg-blue-600":"bg-gray-200"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(e.settings.reminderEnabled?"translate-x-6":"translate-x-1")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Reminder Interval: ",e.settings.reminderInterval," minutes"]}),(0,a.jsx)("input",{type:"range",min:"10",max:"60",value:e.settings.reminderInterval,onChange:e=>m("reminderInterval",parseInt(e.target.value)),className:"mt-1 block w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Break Duration: ",e.settings.breakDuration," seconds"]}),(0,a.jsx)("input",{type:"range",min:"20",max:"300",step:"10",value:e.settings.breakDuration,onChange:e=>m("breakDuration",parseInt(e.target.value)),className:"mt-1 block w-full"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Goals"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Daily Break Goal: ",e.settings.dailyBreakGoal," breaks"]}),(0,a.jsx)("input",{type:"range",min:"3",max:"20",value:e.settings.dailyBreakGoal,onChange:e=>m("dailyBreakGoal",parseInt(e.target.value)),className:"mt-1 block w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Eye Score Goal: ",e.settings.eyeScoreGoal]}),(0,a.jsx)("input",{type:"range",min:"60",max:"100",value:e.settings.eyeScoreGoal,onChange:e=>m("eyeScoreGoal",parseInt(e.target.value)),className:"mt-1 block w-full"})]})]})]})]}),"privacy"===o.activeTab&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Privacy Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Metrics Only Mode"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Store only aggregated metrics, no raw data"})]}),(0,a.jsx)("button",{onClick:()=>m("metricsOnly",!e.settings.metricsOnly),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(e.settings.metricsOnly?"bg-blue-600":"bg-gray-200"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(e.settings.metricsOnly?"translate-x-6":"translate-x-1")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Data Retention: ",e.settings.dataRetention," days"]}),(0,a.jsx)("input",{type:"range",min:"7",max:"365",value:e.settings.dataRetention,onChange:e=>m("dataRetention",parseInt(e.target.value)),className:"mt-1 block w-full"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Data Management"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:t,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Export My Data"}),(0,a.jsx)("button",{onClick:n,className:"w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors",children:"Erase All Data"})]})]})]}),"analytics"===o.activeTab&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Analytics view coming soon..."})}),"goals"===o.activeTab&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Goals management coming soon..."})})]})})},c=()=>{const[e,s]=r.useState({userData:null,isLoading:!0,error:null});r.useEffect(()=>{t()},[]);const t=async()=>{try{const e=await l.ChromeStorageService.getUserData();if(e)s(s=>({...s,userData:e,isLoading:!1}));else{await l.ChromeStorageService.initialize();const e=await l.ChromeStorageService.getUserData();s(s=>({...s,userData:e,isLoading:!1}))}}catch(e){console.error("Failed to load user data:",e),s(e=>({...e,error:"Failed to load user data",isLoading:!1}))}};return e.isLoading?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):e.error?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-red-800 font-medium",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600 text-sm",children:e.error})]})]}),(0,a.jsx)("button",{onClick:t,className:"mt-4 w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition-colors",children:"Retry"})]})}):e.userData?(0,a.jsx)(o,{userData:e.userData,onUpdateSettings:async t=>{if(e.userData)try{const a={...e.userData,settings:{...e.userData.settings,...t},lastUpdated:Date.now()};await l.ChromeStorageService.saveUserData(a),s(e=>({...e,userData:a})),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage({type:"SETTINGS_UPDATED",data:{settings:a.settings},timestamp:Date.now()})}catch(e){console.error("Failed to update settings:",e),s(e=>({...e,error:"Failed to update settings"}))}},onExportData:async()=>{try{const e=await l.ChromeStorageService.exportData(),s=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`eyezen-data-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),alert("Data exported successfully!")}catch(e){console.error("Failed to export data:",e),alert("Failed to export data. Please try again.")}},onEraseData:async()=>{if(confirm("Are you sure you want to erase all your data? This action cannot be undone."))try{await l.ChromeStorageService.clearAllData(),await l.ChromeStorageService.initialize();const e=await l.ChromeStorageService.getUserData();s(s=>({...s,userData:e})),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage({type:"DATA_ERASED",timestamp:Date.now()}),alert("All data has been erased successfully.")}catch(e){console.error("Failed to erase data:",e),alert("Failed to erase data. Please try again.")}}}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"No user data found"}),(0,a.jsx)("button",{onClick:t,className:"mt-4 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors",children:"Initialize Data"})]})})},d=document.getElementById("options-root");d?(0,n.createRoot)(d).render((0,a.jsx)(c,{})):console.error("Options root element not found")},982:(e,s,t)=>{e.exports=t(463)}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var t=r[e]={exports:{}};return a[e](t,t.exports,n),t.exports}n.m=a,e=[],n.O=(s,t,a,r)=>{if(!t){var l=1/0;for(d=0;d<e.length;d++){for(var[t,a,r]=e[d],i=!0,o=0;o<t.length;o++)(!1&r||l>=r)&&Object.keys(n.O).every(e=>n.O[e](t[o]))?t.splice(o--,1):(i=!1,r<l&&(l=r));if(i){e.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,a,r]},n.d=(e,s)=>{for(var t in s)n.o(s,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((s,t)=>(n.f[t](e,s),s),[])),n.u=e=>e+".js",n.miniCssF=e=>{},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),s={},t="eyezen-chrome-extension:",n.l=(e,a,r,l)=>{if(s[e])s[e].push(a);else{var i,o;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var m=c[d];if(m.getAttribute("src")==e||m.getAttribute("data-webpack")==t+r){i=m;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+r),i.src=e),s[e]=[a];var x=(t,a)=>{i.onerror=i.onload=null,clearTimeout(u);var r=s[e];if(delete s[e],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach(e=>e(a)),t)return t(a)},u=setTimeout(x.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=x.bind(null,i.onerror),i.onload=x.bind(null,i.onload),o&&document.head.appendChild(i)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var s=n.g.document;if(!e&&s&&(s.currentScript&&"SCRIPT"===s.currentScript.tagName.toUpperCase()&&(e=s.currentScript.src),!e)){var t=s.getElementsByTagName("script");if(t.length)for(var a=t.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=t[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={575:0,820:0};n.f.j=(s,t)=>{var a=n.o(e,s)?e[s]:void 0;if(0!==a)if(a)t.push(a[2]);else if(820!=s){var r=new Promise((t,r)=>a=e[s]=[t,r]);t.push(a[2]=r);var l=n.p+n.u(s),i=new Error;n.l(l,t=>{if(n.o(e,s)&&(0!==(a=e[s])&&(e[s]=void 0),a)){var r=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;i.message="Loading chunk "+s+" failed.\n("+r+": "+l+")",i.name="ChunkLoadError",i.type=r,i.request=l,a[1](i)}},"chunk-"+s,s)}else e[s]=0},n.O.j=s=>0===e[s];var s=(s,t)=>{var a,r,[l,i,o]=t,c=0;if(l.some(s=>0!==e[s])){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(o)var d=o(n)}for(s&&s(t);c<l.length;c++)r=l[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},t=self.webpackChunkeyezen_chrome_extension=self.webpackChunkeyezen_chrome_extension||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var l=n.O(void 0,[644,123,820],()=>n(501));l=n.O(l)})();